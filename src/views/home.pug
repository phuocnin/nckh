extends index

block content
  .col-12
    .card
      .card-body
        | Chào mừng !

  .card-body
    table.table.table-hover.table-condensed#list
      colgroup
        col(width="60%")
        col(width="10%")
        col(width="10%")

      thead
        tr
          th.text-center Thông báo
          th.text-center Ngày đăng
          th.text-center Hoạt động             
      tbody
        each notify in data
          tr
            td
              p
                b= notify.ThongBao
              p.truncate= notify.NoiDung.split(" ").slice(0, 10).join(" ")
            td.text-center
              b= notify.createdAt.toLocaleDateString()

            td.text-center

              form(id=`deleteForm_${notify._id}`, style="display:inline;")
                button.btn.btn-default.btn-sm.btn-flat.border-info.wave-effect.text-info.dropdown-toggle(type="button", data-toggle="dropdown", aria-expanded="true") Hoạt động
                .dropdown-menu
                  a.dropdown-item.view_project(href=`/notify/${notify._id}`) Xem
                  .dropdown-divider
                  button.dropdown-item(type="button", onclick=`editNotify('${notify._id}')`) Chỉnh sửa
                  .dropdown-divider
                  button.dropdown-item(type="button", onclick=`deleteNotify('${notify._id}')`) Xóa
          //- Modal chỉnh sửa
          div#editModal.modal
            div.modal-dialog(style="width: 70vw; margin-top: 0vh;")
              div.modal-content(style="max-height: 80vh; overflow-y: auto;")
                span.close(onclick="closeEditModal()") &times;
                h2 Chỉnh sửa thông báo
                form(class=`edit-form-${notify._id}`)
                  label Thông báo
                  input#editThongbao(type="text" name="editThongbao" class="form-control" required)
                  label Nội dung
                  textarea#editNoidung(name="editNoidung" class="form-control" required)            
                
                  .col-lg-12.text-right.justify-content-center.d-flex
                      button.btn.btn-primary(type="button" onclick=`saveEditForm('${notify._id}')`) Lưu
                      button.btn.btn-secondary(type="button" onclick="closeEditModal()") Hủy

  style.
    table p {
      margin: unset !important;
    }
    table td {
      vertical-align: middle !important;
    }

  script.
    $(document).ready(function(){
      $('#list').dataTable();

      $('.delete_project').click(function(){
        _conf("Are you sure to delete this project?", "delete_project", [$(this).data('id')]);
      });

      function delete_project(id){
        start_load();
        $.ajax({
          url: 'ajax.php?action=delete_project',
          method: 'POST',
          data: {id: id},
          success: function(resp){
            if(resp == 1){
              alert_toast("Data successfully deleted", 'success');
              setTimeout(function(){
                location.reload();
              }, 1500);
            }
          }
        });
      }
    });
