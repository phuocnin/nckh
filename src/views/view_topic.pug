extends index  


block content
    .col-lg-12
        .row
            .col-md-12
                .callout.callout-info
                    td.text-center
                        button.btn.btn-default.btn-sm.btn-flat.border-info.wave-effect.text-info.dropdown-toggle(type="button", data-toggle="dropdown", aria-expanded="true").
                             Action
                        .dropdown-menu
                            a.dropdown-item.view_task(href="javascript:void(0)") sửa
                            .dropdown-divider
                            a.dropdown-item.edit_task(href="javascript:void(0)") xóa
                            .dropdown-divider
                            
                    .col-md-12
                        .row
                            
                            .col-sm-6
                                dl
                                    dt
                                        b.border-bottom.border-primary Tên đề tài
                                    dd= data.TenDeTai
                                    dt
                                        b.border-bottom.border-primary Miêu tả
                                    dd= data.MoTa
                            .col-md-6
                                dl
                                    dt
                                        b.border-bottom.border-primary Ngày bắt đầu
                                    -if(data.NgayThucHien)
                                        dd= data.NgayThucHien.toLocaleDateString()
                                dl
                                    dt
                                        b.border-bottom.border-primary Ngày kết thúc
                                    -if(data.NgayKetThuc)
                                        dd= data.NgayKetThuc.toLocaleDateString()
                                dl
                                    dt
                                        b.border-bottom.border-primary Trạng thái
                                    dd= data.TrangThai                             
                                dl
                                    dt
                                        b.border-bottom.border-primary Quản lí dự án                                    
                                    dd 
                                        .d-flex.align-items-center.mt-1                                        
                                            img.img-circle.img-thumbnail.p-0.shadow-sm.border-info.img-sm.mr-3(src="assets/uploads/<?php echo $manager[\'avatar\'] ?>", alt="Avatar")
                                            b= data.GiangVien 
            
        .row
            .col-md-4
                .card.card-outline(style="min-height:129.67px").card-primary
                    .card-header
                        span 
                            b Thành viên nhóm:
                            .card-tools
                    .card-body                        
                        ul.users-list.clearfix 
                            //- each ThanhVien in data.ThanhVien                       
                            //-     li                             
                            //-         img(src="assets/uploads/<?php echo $row[\'avatar\'] ?>", alt="User Image")
                            //-         a.users-list-name(href="javascript:void(0)")= ThanhVien
                      
            if user.role =="admin" & data.TrangThai=="chờ phê duyệt"           
                .col-md-8
                    .card.card-outline.card-primary
                        .card-header
                            span
                                if data.TrangThai=="chờ phê duyệt"
                                    b Xét duyệt đề tài:
                                else if data.TrangThai=="chờ nghiệm thu"
                                    b Nghiệm thu đề tài:
                            td.text-center
                                if data.TrangThai=="chờ phê duyệt"
                                    select.custom-select.custom-select-sm(id="roleSelect" name="role")
                                        option(value="đang thực hiện") Duyệt
                                        option(value="hủy") Không duyệt
                                        input#trangthai(type="hidden" name="role" value="Đang thực hiện")
                                if data.TrangThai=="chờ nghiệm thu"
                                    select.custom-select.custom-select-sm(id="roleSelect" name="role")
                                        option(value="hoàn thành") Đạt
                                        option(value="hủy") Không đạt
                                        input#trangthai(type="hidden" name="role" value="Đang thực hiện")
                            .card-tools
                                button.btn.btn-primary.bg-gradient-primary.btn-sm#new_task(type="button")
                                    i.fa  Xác nhận

            if user.role =="admin" & data.TrangThai=="phân công xét duyệt"           
                .col-md-8
                    .card.card-outline.card-primary
                        .card-header    
                            td.text-center
                                    .form-group
                                        label.control-label 
                                            if data.TrangThai=="phân công xét duyệt"
                                                b Phân công xét duyệt:
                                            else if data.TrangThai=="chờ nghiệm thu"
                                                b Phân công nghiệm thu:
                                        select#userDropdown.form-control.form-control-sm.select2
                                            option(value="" disabled selected)

                            .card-tools
                                button.btn.btn-primary.bg-gradient-primary.btn-sm#new_task(type="button")
                                    i.fa  Xác nhận
    iframe(
      src="https://docs.google.com/gview?url=https://drive.google.com/file/d/17vMotMK5LiwEqJIMzNaHlOWqJ7P4YAfZ/view?usp=sharing&embedded=true"
      style="width: 600px; height: 780px"
    )
        
    style.
        .users-list>li img {
            border-radius: 50%;
            height: 67px;
            width: 67px;
            object-fit: cover;
        }
        .users-list>li {
            width: 33.33% !important
        }
        .truncate {
            -webkit-line-clamp:1 !important;
        }


    //- script.
    //-   document.addEventListener("DOMContentLoaded", function() {
    //-     var iframe = document.createElement("iframe");
    //-     iframe.src = "http://localhost:3000/file/1.pdf";
    //-     iframe.width = "600";
    //-     iframe.height = "780";
    //-     iframe.frameBorder = "0";
    //-     iframe.style.border = "none";
    //-     iframe.loading = "lazy";
        
    //-     // Thay thế #pdf-container bằng ID hoặc class phù hợp trên trang của bạn
    //-     document.getElementById("pdf-container").appendChild(iframe);
    //-   });
    
    script.


        $('#new_task').click(function(){
            uni_modal("New Task For <?php echo ucwords($name) ?>","manage_task.php?pid=<?php echo $id ?>","mid-large")
            })
            $('.edit_task').click(function(){
                uni_modal("Edit Task: "+$(this).attr('data-task'),"manage_task.php?pid=<?php echo $id ?>&id="+$(this).attr('data-id'),"mid-large")
            })
            $('.view_task').click(function(){
                uni_modal("Task Details","view_task.php?id="+$(this).attr('data-id'),"mid-large")
            })
            $('#new_productivity').click(function(){
                uni_modal("<i class='fa fa-plus'></i> New Progress","manage_progress.php?pid=<?php echo $id ?>",'large')
            })
            $('.manage_progress').click(function(){
                uni_modal("<i class='fa fa-edit'></i> Edit Progress","manage_progress.php?pid=<?php echo $id ?>&id="+$(this).attr('data-id'),'large')
            })
            $('.delete_progress').click(function(){
            _conf("Are you sure to delete this progress?","delete_progress",[$(this).attr('data-id')])
            })
            function delete_progress($id){
                start_load()
                $.ajax({
                    url:'ajax.php?action=delete_progress',
                    method:'POST',
                    data:{id:$id},
                    success:function(resp){
                        if(resp==1){
                            alert_toast("Data successfully deleted",'success')
                            setTimeout(function(){
                                location.reload()
                            },1500)

                        }
                    }
                })
            }
